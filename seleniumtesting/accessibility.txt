from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from docx import Document

# Create a new instance of the Microsoft Edge WebDriver
driver = webdriver.Edge()

# Open the website to test
driver.get("https://digitalservices.dglapm.id/documentation/get-started#")  # Replace with the actual website URL

# Find the target element by ID
target_element = driver.find_element(By.ID, ":0.targetLanguage")

# Check keyboard accessibility
keyboard_accessible = target_element.is_enabled() and target_element.is_displayed()
if keyboard_accessible:
    print("Keyboard Accessibility Test: Element is keyboard-navigable")
else:
    print("Keyboard Accessibility Test: Element is NOT keyboard-navigable")

# Get the text of the element
element_text = target_element.text

# Verify the expected text is present
expected_text = "Pilih Bahasa"
if expected_text in element_text:
    test_result = "Test passed: Element text matches expected text"
    print(test_result)
else:
    test_result = "Test failed: Element text does not match expected text"
    print(test_result)

# Take a screenshot
driver.save_screenshot(r"C:\Users\user\OneDrive - Yayasan Budi Pekerti Luhur\Python\screenshot.png")

# Save the results to a Word document
doc = Document(r"C:\Users\user\OneDrive - Yayasan Budi Pekerti Luhur\Python\hasil_test_RPA.docx")

# Add a new section for the second test
doc.add_page_break()

# Add the heading and test report for the second test
doc.add_heading('Hasil Test Language Match', level=1)
doc.add_paragraph("Hasil Test: ")
doc.add_paragraph(test_result)

# Add the screenshot for the second test
doc.add_picture(r"C:\Users\user\OneDrive - Yayasan Budi Pekerti Luhur\Python\screenshot.png")

# Save the modified Word document
doc.save(r"C:\Users\user\OneDrive - Yayasan Budi Pekerti Luhur\Python\hasil_test_RPA.docx")

# Close the browser
driver.quit()
